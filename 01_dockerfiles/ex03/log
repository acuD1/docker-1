Starting Chef Client, version 13.6.4[0m
resolving cookbooks for run list: ["gitlab"][0m
Synchronizing Cookbooks:[0m
  - gitlab (0.0.1)[0m
  - package (0.1.0)[0m
  - redis (0.1.0)[0m
  - postgresql (0.1.0)[0m
  - registry (0.1.0)[0m
  - mattermost (0.1.0)[0m
  - consul (0.0.0)[0m
  - gitaly (0.1.0)[0m
  - letsencrypt (0.1.0)[0m
  - nginx (0.1.0)[0m
  - runit (0.14.2)[0m
  - crond (0.1.0)[0m
  - acme (3.1.0)[0m
  - compat_resource (12.19.0)[0m
Installing Cookbook Gems:[0m
Compiling Cookbooks...[0m

================================================================================
  ERROR: Encountered unsupported config key 'redirect_http_to_https' in /etc/gitlab/gitlab.rb.
================================================================================

================================================================================
  ERROR: Encountered unsupported config key 'ssl_certificate' in /etc/gitlab/gitlab.rb.
================================================================================

================================================================================
  ERROR: Encountered unsupported config key 'ssl_certificate_key' in /etc/gitlab/gitlab.rb.
================================================================================
Recipe: gitlab::default[0m
  * directory[/etc/gitlab] action create
    [32m- change mode from '0755' to '0775'[0m
[0m  Converging 512 resources[0m
  * directory[/etc/gitlab] action create (up to date)
  * directory[Create /var/opt/gitlab] action create
    [32m- create new directory /var/opt/gitlab[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/embedded/etc] action create
    [32m- create new directory /opt/gitlab/embedded/etc[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/embedded/etc/gitconfig] action create
    [32m- create new file /opt/gitlab/embedded/etc/gitconfig[0m
    [32m- update content in file /opt/gitlab/embedded/etc/gitconfig from none to f8c837[0m
    [37m--- /opt/gitlab/embedded/etc/gitconfig	2019-02-04 15:42:40.917469816 +0000[0m
    [37m+++ /opt/gitlab/embedded/etc/.chef-gitconfig20190204-14-18xwk7o	2019-02-04 15:42:40.917469816 +0000[0m
    [37m@@ -1 +1,12 @@[0m
    [37m+[pack][0m
    [37m+  threads = 1[0m
    [37m+[receive][0m
    [37m+  fsckObjects = true[0m
    [37m+advertisePushOptions = true[0m
    [37m+[repack][0m
    [37m+  writeBitmaps = true[0m
    [37m+[transfer][0m
    [37m+  hideRefs=^refs/tmp/[0m
    [37m+hideRefs=^refs/keep-around/[0m
    [37m+hideRefs=^refs/remotes/[0m
    [32m- change mode from '' to '0755'[0m
[0mRecipe: gitlab::web-server[0m
  * account[Webserver user and group] action create
    * group[Webserver user and group] action create
      [32m- create group gitlab-www[0m
[0m    * linux_user[Webserver user and group] action create
      [32m- create user gitlab-www[0m
[0m  
[0mRecipe: gitlab::users[0m
  * directory[/var/opt/gitlab] action create (up to date)
  * account[GitLab user and group] action create
    * group[GitLab user and group] action create
      [32m- create group git[0m
[0m    * linux_user[GitLab user and group] action create
      [32m- create user git[0m
[0m  
[0m  * template[/var/opt/gitlab/.gitconfig] action create
    [32m- create new file /var/opt/gitlab/.gitconfig[0m
    [32m- update content in file /var/opt/gitlab/.gitconfig from none to 142be2[0m
    [37m--- /var/opt/gitlab/.gitconfig	2019-02-04 15:42:41.754435269 +0000[0m
    [37m+++ /var/opt/gitlab/.chef-.gitconfig20190204-14-1cusl0u.gitconfig	2019-02-04 15:42:41.753435310 +0000[0m
    [37m@@ -1 +1,12 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+[user][0m
    [37m+        name = GitLab[0m
    [37m+        email = gitlab@192.168.99.100[0m
    [37m+[core][0m
    [37m+        autocrlf = input[0m
    [37m+[gc][0m
    [37m+        auto = 0[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
[0m  * directory[/var/opt/gitlab/.bundle] action create
    [32m- create new directory /var/opt/gitlab/.bundle[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
[0mRecipe: gitlab::gitlab-shell[0m
  * storage_directory[/var/opt/gitlab/.ssh] action create
    * ruby_block[directory resource: /var/opt/gitlab/.ssh] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/.ssh[0m
[0m  
[0m  * directory[/var/log/gitlab/gitlab-shell/] action create
    [32m- create new directory /var/log/gitlab/gitlab-shell/[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/var/opt/gitlab/gitlab-shell] action create
    [32m- create new directory /var/opt/gitlab/gitlab-shell[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * templatesymlink[Create a config.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-shell/config.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-shell/config.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-shell/config.yml from none to d824f9[0m
      [37m--- /var/opt/gitlab/gitlab-shell/config.yml	2019-02-04 15:42:41.986425693 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-shell/.chef-config20190204-14-3malkm.yml	2019-02-04 15:42:41.985425734 +0000[0m
      [37m@@ -1 +1,44 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+# GitLab user. git by default[0m
      [37m+user: git[0m
      [37m+[0m
      [37m+# Url to gitlab instance. Used for api calls. Should end with a slash.[0m
      [37m+gitlab_url: "http://127.0.0.1:8080"[0m
      [37m+[0m
      [37m+http_settings:[0m
      [37m+  [0m
      [37m+#  user: someone[0m
      [37m+#  password: somepass[0m
      [37m+#  ca_file: /etc/ssl/cert.pem[0m
      [37m+#  ca_path: /etc/pki/tls/certs[0m
      [37m+#  self_signed_cert: false[0m
      [37m+[0m
      [37m+# File used as authorized_keys for gitlab user[0m
      [37m+auth_file: "/var/opt/gitlab/.ssh/authorized_keys"[0m
      [37m+[0m
      [37m+# Redis settings used for pushing commit notices to gitlab[0m
      [37m+redis:[0m
      [37m+  host: 127.0.0.1[0m
      [37m+  port: [0m
      [37m+  socket: /var/opt/gitlab/redis/redis.socket[0m
      [37m+  database: [0m
      [37m+  namespace: resque:gitlab[0m
      [37m+[0m
      [37m+# Log file.[0m
      [37m+# Default is gitlab-shell.log in the root directory.[0m
      [37m+log_file: "/var/log/gitlab/gitlab-shell/gitlab-shell.log"[0m
      [37m+[0m
      [37m+# Log level. INFO by default[0m
      [37m+log_level: [0m
      [37m+[0m
      [37m+[0m
      [37m+# Audit usernames.[0m
      [37m+# Set to true to see real usernames in the logs instead of key ids, which is easier to follow, but[0m
      [37m+# incurs an extra API call on every gitlab-shell command.[0m
      [37m+audit_usernames: [0m
      [37m+[0m
      [37m+[0m
      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml[0m
[0m  
[0m  * link[/opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret] action create
    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret to /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret[0m
[0m  * execute[/opt/gitlab/embedded/service/gitlab-shell/bin/gitlab-keys check-permissions] action run
    [32m- execute /opt/gitlab/embedded/service/gitlab-shell/bin/gitlab-keys check-permissions[0m
[0m  * bash[Set proper security context on ssh files for selinux] action run (skipped due to only_if)
Recipe: gitlab::gitlab-rails[0m
  * storage_directory[/var/opt/gitlab/git-data] action create
    * ruby_block[directory resource: /var/opt/gitlab/git-data] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/git-data[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/git-data/repositories] action create
    * ruby_block[directory resource: /var/opt/gitlab/git-data/repositories] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/git-data/repositories[0m
[0m  
[0m  * directory[/var/log/gitlab] action create
    [32m- change owner from 'root' to 'git'[0m
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/artifacts] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/lfs-objects] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/packages] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/packages] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/packages[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/uploads] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/uploads] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/uploads[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-ci/builds] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-ci/builds] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-ci/builds[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/cache] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/cache] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/cache[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/tmp] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/pages] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/pages] action run^C
[1mTraceback[m (most recent call last):
	7: from /opt/gitlab/embedded/bin/omnibus-ctl:23:in `<main>'
	6: from /opt/gitlab/embedded/bin/omnibus-ctl:23:in `load'
	5: from /opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/bin/omnibus-ctl:31:in `<top (required)>'
	4: from /opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb:746:in `run'
	3: from /opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb:516:in `reconfigure'
	2: from /opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb:503:in `run_chef'
	1: from /opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb:238:in `run_command'
/opt/gitlab/embedded/lib/ruby/gems/2.5.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb:238:in `system': [1m[1;4mInterrupt
[m
    [0m
    Running handlers:[0m
[31mThere was an error running gitlab-ctl reconfigure:[0m

[31mexit[0m

    Running handlers complete
[0m    Chef Client failed. 42 resources updated in 08 seconds[0m

